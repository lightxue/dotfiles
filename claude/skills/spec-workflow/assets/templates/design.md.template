# {功能名称} - 技术设计文档

> 文档路径：.specs/{feature_name}-{requirement_id}/design.md
> 创建时间：{YYYY-MM-DD}
> 需求来源：【{需求标题}】{需求来源链接或描述}
> 关联wiki：[README](../../doc/README.md) | [架构](../../doc/architecture.md) | [接口](../../doc/interfaces.md) | [实现](../../doc/implementation.md)

## 概述

### 需求说明

<!-- 需求基本信息 -->

**需求标题**：{需求标题}
**需求来源**：{TAPD链接 或 用户文字描述}
**需求描述**：{需求详细描述}
**验收标准**：{验收标准列表}

### 迭代目标

<!-- 与需求对齐的目标 -->

{迭代目标内容}

### 项目现状分析

<!-- 基于项目wiki文档：doc/README.md + architecture.md + interfaces.md + implementation.md -->

- **现有实现**：{当前实现方式}
- **待优化点**：{问题和瓶颈}
- **影响范围**：{涉及的模块、接口、数据}

**Wiki参考章节**：
- 架构设计：[doc/architecture.md](../../doc/architecture.md)
- 接口定义：[doc/interfaces.md](../../doc/interfaces.md)
- 实现细节：[doc/implementation.md](../../doc/implementation.md)

## 歧义与待确认清单

> **⚠️ 重要说明**：
>
> 1. **强制格式要求**：所有待确认项必须使用 `- [ ]` 未勾选格式
> 2. **禁止行为**：AI 不得自行标记为 `- [x]` 已确认
> 3. **分组确认流程**（3个固定分组）：
>    - AI 生成文档后，按顺序展示【需求理解组】→【技术方案组】→【边界条件组】
>    - 每组一次性展示所有待确认项，等待用户批量回答
>    - 用户回答后，AI 将该组所有项标记为 `- [x]` 并补充答案
>    - 如某个分组确实无待确认项，必须明确标注「无」
> 4. **审批门禁**：所有分组未确认完毕时，无法通过阶段1审批！

### 需求理解疑问

<!-- AI：列出对需求理解的不确定项，如无则标注「无」 -->

- [ ] **疑问 1**：{对需求的理解疑问}
  - 当前理解：{你的理解}
  - 待确认：{需要用户明确的内容}
  - 影响范围：{如果理解有误会影响哪些设计}

- [ ] **疑问 2**：{对需求的理解疑问}
  - 当前理解：{你的理解}
  - 待确认：{需要用户明确的内容}

### 技术方案待定项

<!-- AI：列出技术选型、架构决策的待定项，如无则标注「无」 -->

- [ ] **待定 1**：{技术选型或实现方式的待定项}
  - 方案 A：{方案描述及优缺点}
  - 方案 B：{方案描述及优缺点}
  - 推荐方案：{推荐及理由}
  - 待确认：{需要用户决策的内容}

- [ ] **待定 2**：{技术选型或实现方式的待定项}
  - 推荐方案：{推荐及理由}
  - 待确认：{需要用户决策的内容}

### 边界条件确认

<!-- AI：列出业务边界、异常处理、性能指标等待确认项，如无则标注「无」 -->

- [ ] **边界 1**：{需要明确的业务边界或异常场景}
  - 场景描述：{具体场景}
  - 当前假设：{你的假设处理方式}
  - 待确认：{需要用户明确的处理策略}

- [ ] **边界 2**：{需要明确的性能指标或限制条件}
  - 当前假设：{你的假设值}
  - 待确认：{需要用户明确的具体指标}

> **分组确认步骤说明**：
>
> 1. **第1组确认**：AI 一次性展示【需求理解疑问】所有项 → 等待用户批量回答 → 标记为 `- [x]`
> 2. **第2组确认**：AI 一次性展示【技术方案待定项】所有项 → 等待用户批量回答 → 标记为 `- [x]`
> 3. **第3组确认**：AI 一次性展示【边界条件确认】所有项 → 等待用户批量回答 → 标记为 `- [x]`
> 4. **如某组无待确认项**：删除该组的示例条目，标注「无」
> 5. **审批前提**：所有3个分组必须已确认（标记 `- [x]`）或标注「无」

## 架构设计

### 整体架构

<!-- 架构图示例，根据实际情况调整 -->

```mermaid
graph TD
    A[客户端] --> B[API网关]
    B --> C[业务服务]
    C --> D[数据层]
```

### 改动说明

<!-- 描述本次需求对架构的改动 -->

{架构改动描述}

## 改动分析

### 新增模块

<!-- 列出新增的模块 -->

- **{模块名称}**
  - 功能职责：{功能描述}
  - 技术选型：{技术栈}
  - 关键组件：{组件列表}

### 修改模块

<!-- 列出需要修改的模块 -->

- **{模块名称}**
  - 修改原因：{为什么要修改}
  - 修改内容：{具体改动}
  - 影响范围：{影响的其他模块}

### 删除模块

<!-- 列出需要删除的模块，如无则删除此小节 -->

- **{模块名称}**
  - 删除原因：{为什么删除}
  - 替代方案：{如何替代原功能}

## 依赖服务调用

> **📌 填写说明**：
> - 如果需求**涉及依赖服务**：保留下方对应的小节（医保服务依赖 或 通用组件依赖），删除"无依赖服务调用"小节
> - 如果需求**不涉及依赖服务**：只保留"无依赖服务调用"小节，删除其他两个小节
> - 使用 THWiki-MCP-Server 检索相关服务文档（yibao目录/thcomm目录）

### 医保服务依赖（如不涉及请删除此小节）

<!-- 基于 THWiki-MCP-Server 检索 yibao 目录获取的服务文档 -->

- 服务名称：{服务名}
- 接口地址：{接口URL}
- 调用方式：{GET/POST等}
- 参数说明：{请求参数}
- 返回格式：{响应格式}
- 注意事项：{特殊要求或限制}

### 通用组件依赖（如不涉及请删除此小节）

<!-- 基于 THWiki-MCP-Server 检索 thcomm 目录获取的组件文档 -->

- 组件名称：{组件名}
- 使用方式：{引入和调用方法}
- 配置参数：{必要配置}
- 注意事项：{特殊要求或限制}

### 无依赖服务调用（如涉及依赖服务请删除此小节）

本次需求为纯前端功能/独立后端逻辑，不涉及外部依赖服务调用。

## 接口与数据

### 新增接口

#### 接口 1：{接口名称}

- **路径**：`/api/v1/{path}`
- **方法**：GET/POST/PUT/DELETE
- **请求参数**：
  ```json
  {
    "param1": "string",
    "param2": "number"
  }
  ```
- **响应格式**：
  ```json
  {
    "code": 0,
    "message": "success",
    "data": {}
  }
  ```
- **功能说明**：{接口功能描述}

### 修改接口

#### 接口 1：{接口名称}

- **路径**：`/api/v1/{path}`
- **修改内容**：{具体改动}
- **影响说明**：{对现有调用方的影响}

### 数据模型

#### 模型 1：{模型名称}

```typescript
interface ModelName {
  id: string;
  name: string;
  createdAt: Date;
  updatedAt: Date;
}
```

**字段说明**：
- `id`：唯一标识符
- `name`：名称
- `createdAt`：创建时间
- `updatedAt`：更新时间

## 技术难点与对策

### 难点 1：{难点描述}

- **问题描述**：{具体问题}
- **技术挑战**：{为什么困难}
- **解决方案**：{如何解决}
- **备选方案**：{如果失败的Plan B}

### 难点 2：{难点描述}

- **问题描述**：{具体问题}
- **技术挑战**：{为什么困难}
- **解决方案**：{如何解决}
- **备选方案**：{如果失败的Plan B}

## 风险识别与应对

### 风险 1：{风险描述}

- **风险等级**：高/中/低
- **影响范围**：{影响哪些功能或模块}
- **技术应对**：{技术层面的解决方案}
- **监控建议**：{建议监控的关键指标}

### 风险 2：{风险描述}

- **风险等级**：高/中/低
- **影响范围**：{影响哪些功能或模块}
- **技术应对**：{技术层面的解决方案}

## 附录

### 参考文档

- [相关需求文档](link)
- [技术文档](link)
- [API 文档](link)

### 变更记录

| 日期 | 版本 | 修改内容 | 修改人 |
|------|------|---------|--------|
| {YYYY-MM-DD} | 1.0 | 初始版本 | {姓名} |
