---
phase: 3
name: 计划执行
description: 分组执行任务、质量检查、用户确认、最终验收、生成执行总结文档
outputs: execution_summary.md + 审批通过
---

# 阶段 3：计划执行

## 阶段目标

✅ 按分组顺序执行所有任务  
✅ 每个分组通过质量检查  
✅ 获得用户分组确认  
✅ 最终质量检查通过  
✅ 生成执行总结文档并通过审批

## 🚨 执行核心规则（始终遵守）

1. **实时更新状态** - 每个任务状态变更立即更新 tasks.md，禁止延迟或批量更新
2. **强制分组确认** - 每个分组完成后必须停止并等待用户确认，禁止自动继续
3. **严格按 tasks.md 执行** - 所有任务（包括2个强制分组）必须按 tasks.md 中定义的顺序完整执行

## 执行步骤

下列步骤 ✅ **全部完成**后，项目需求开发工作流完成。

> **📌 重要说明**：
> - 所有任务定义、执行细节、验证脚本均在 `tasks.md` 中
> - 阶段3只需按 tasks.md 中的分组顺序执行所有任务即可
> - **分组N-1**：文档更新与验证（T{N}使用 spec-workflow skill 验证wiki）
> - **分组N**：最终验收与审批（T{N+1}-T{N+4}全部使用 spec-workflow skill）

### Step 1：验证前置条件 ⭐

**强制检查点**：

```bash
cd <项目根目录> && python3 <SKILL_DIR>/scripts/phase_gateway.py --check-phase 3
```

**检查内容**：阶段 2 完成状态、任务规划审批、tasks.md 存在

**⚠️ 必须通过**（exit code = 0）才能开始执行

📖 **详细说明**：[验证操作手册 - 前置条件检查](../scripts-reference.md#5-phase_gatewaypy---check-phase-n---前置条件检查)

---

### Step 2：按 tasks.md 分组顺序执行所有任务 ⭐

**执行原则**：严格按照 `tasks.md` 中定义的分组和任务顺序执行

#### 执行流程（单个分组）

```
识别分组 → 执行任务 → 质量检查 → 用户确认 → 下一分组（重复）
```

**单个任务执行**：
1. 开始任务：更新状态 `todo → doing`，立即同步到 tasks.md
2. 实现任务：按任务描述中的要求执行（编写代码/运行脚本/生成文档等）
3. 自测验证：功能正常，测试通过，无明显bug
4. 完成任务：更新状态 `doing → done`，立即同步到 tasks.md

**分组质量检查（6项）**：
- [ ] 所有任务已完成（状态为 done）
- [ ] 代码功能已实现并测试通过
- [ ] 单元测试已编写（覆盖核心逻辑）
- [ ] 代码符合项目规范
- [ ] 无明显 bug 或性能问题
- [ ] 验收标准已满足

**用户确认**：
- 分组检查通过后，**必须停止并等待用户确认**
- 展示完成任务列表 + 显示下一分组信息
- 等待有效确认用语（`确认无误` `继续下一分组` `没问题` `通过`）
- ✅ 收到确认 → 继续 | ❌ 提出问题 → 修复 | ⏸️ 无回复 → 等待

#### 2个强制分组的执行要点

**分组 N-1（文档更新与验证）**：
- T{N-1}：更新项目wiki文档（手动编写）
- T{N}：验证wiki文档完整性（**使用 spec-workflow skill**）
  - 执行验证脚本 `validate_wiki.py`
  - 必须通过（exit code = 0）
- ✅ 完成后等待用户确认，然后进入分组N

**分组 N（最终验收与审批）**：
- T{N+1}：验证任务完成状态（**使用 spec-workflow skill**）
- T{N+2}：最终质量检查（**使用 spec-workflow skill**）
- T{N+3}：生成执行总结文档（**使用 spec-workflow skill**）
- T{N+4}：等待人工审批（**使用 spec-workflow skill**）
- ✅ 完成后无需单独确认，审批通过即完成工作流

> **📌 详细执行说明**：所有任务的详细描述、验证命令、质量要求均在 `tasks.md` 中定义

---

**快速参考**：
```
Step 1（前置检查）→ Step 2（按 tasks.md 执行所有分组）
```

> **📌 提示**：所有任务的详细执行步骤、验证脚本、质量要求均在 `tasks.md` 中定义



---

## 关键任务说明

> **📌 所有任务的详细定义均在 `tasks.md` 中**

**分组 N-1（文档更新与验证）**：
- T{N-1}：更新项目wiki文档（手动编写）
- T{N}：验证wiki文档（使用 spec-workflow skill，执行 `validate_wiki.py`）

**分组 N（最终验收与审批）**：
- T{N+1}：验证任务完成（使用 spec-workflow skill，执行 `validate_tasks.py --phase execution`）
- T{N+2}：质量检查（CRITICAL项必须通过：单元测试≥80%、回归测试通过）
- T{N+3}：生成总结（基于 `execution_summary.md.template`）
- T{N+4}：人工审批（使用有效审批用语）

> **📖 详细执行步骤**：请查看 `.specs/{feature_name}-{requirement_id}/tasks.md`

---

## 完成标志

✅ 阶段3审批通过后：
- 输出完成总结（任务统计、质量检查、交付物清单、审批记录）
- 显示"项目需求开发工作流完成 🎉"

---

## 相关文档

- [阶段2: 任务规划](phase-2-tasks.md) - 任务规划参考（含2个强制分组）
- [审批操作手册](../approval-guide.md) - 审批流程详解
- [脚本命令参考](../scripts-reference.md) - 验证脚本使用
